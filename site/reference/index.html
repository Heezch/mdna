
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.31">
    
    
      
        <title>Reference - Software module for DNA structure analysis and generation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pymdna.nucleic" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Software module for DNA structure analysis and generation" class="md-header__button md-logo" aria-label="Software module for DNA structure analysis and generation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Software module for DNA structure analysis and generation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Software module for DNA structure analysis and generation" class="md-nav__button md-logo" aria-label="Software module for DNA structure analysis and generation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Software module for DNA structure analysis and generation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MDNA Docs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../explanation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explanation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-guides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How-To Guides
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modules-build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modules-modify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modify
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modules-analyse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analyse
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nucleic-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nucleic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shapes-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shapes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geometry-reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic" class="md-nav__link">
    <span class="md-ellipsis">
      nucleic
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic" class="md-nav__link">
    <span class="md-ellipsis">
      Nucleic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Nucleic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.describe" class="md-nav__link">
    <span class="md-ellipsis">
      describe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.draw" class="md-nav__link">
    <span class="md-ellipsis">
      draw
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.extend" class="md-nav__link">
    <span class="md-ellipsis">
      extend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.flip" class="md-nav__link">
    <span class="md-ellipsis">
      flip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.get_MC_traj" class="md-nav__link">
    <span class="md-ellipsis">
      get_MC_traj
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.get_frames" class="md-nav__link">
    <span class="md-ellipsis">
      get_frames
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.get_linking_number" class="md-nav__link">
    <span class="md-ellipsis">
      get_linking_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.get_rigid_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_rigid_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.get_traj" class="md-nav__link">
    <span class="md-ellipsis">
      get_traj
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.invert" class="md-nav__link">
    <span class="md-ellipsis">
      invert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.methylate" class="md-nav__link">
    <span class="md-ellipsis">
      methylate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.minimize" class="md-nav__link">
    <span class="md-ellipsis">
      minimize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.mutate" class="md-nav__link">
    <span class="md-ellipsis">
      mutate
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mutate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.mutate--create-a-dna-object" class="md-nav__link">
    <span class="md-ellipsis">
      Create a DNA object
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.Nucleic.mutate--mutate-the-dna-trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      Mutate the DNA trajectory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.compute_curvature" class="md-nav__link">
    <span class="md-ellipsis">
      compute_curvature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.compute_groove_width" class="md-nav__link">
    <span class="md-ellipsis">
      compute_groove_width
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.compute_linking_number" class="md-nav__link">
    <span class="md-ellipsis">
      compute_linking_number
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.compute_rigid_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      compute_rigid_parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="compute_rigid_parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.compute_rigid_parameters--compute-the-rigid-base-parameters-of-a-dna-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Compute the rigid base parameters of a DNA structure
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.connect" class="md-nav__link">
    <span class="md-ellipsis">
      connect
    </span>
  </a>
  
    <nav class="md-nav" aria-label="connect">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.connect--connect-two-dna-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Connect two DNA structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.make" class="md-nav__link">
    <span class="md-ellipsis">
      make
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.sequence_to_md" class="md-nav__link">
    <span class="md-ellipsis">
      sequence_to_md
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sequence_to_md">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.sequence_to_md--simulate-a-linear-dna-structure-for-100-picoseconds-at-300-k" class="md-nav__link">
    <span class="md-ellipsis">
      Simulate a linear DNA structure for 100 picoseconds at 300 K
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pymdna.nucleic.sequence_to_pdb" class="md-nav__link">
    <span class="md-ellipsis">
      sequence_to_pdb
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sequence_to_pdb">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pymdna.nucleic.sequence_to_pdb--generate-a-dna-structure-from-a-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      Generate a DNA structure from a sequence
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Reference</h1>

<p>This part of the project documentation focuses on
an <strong>information-oriented</strong> approach. Use it as a
reference for the technical implementation of the
<code>mdna</code> project code.</p>


<div class="doc doc-object doc-module">



<a id="pymdna.nucleic"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="pymdna.nucleic.Nucleic" class="doc doc-heading">
            <code>Nucleic</code>


<a href="#pymdna.nucleic.Nucleic" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


      <p>Contains mdna DNA structure with reference frames and trajectory</p>

              <details class="quote">
                <summary>Source code in <code>pymdna/nucleic.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Nucleic</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains mdna DNA structure with reference frames and trajectory&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">traj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Initializes the DNA structure.</span>

<span class="sd">            Args:</span>
<span class="sd">                sequence (str): The DNA sequence, e.g. &#39;CGCGAATTCGCG&#39;.</span>
<span class="sd">                n_bp (int): The number of base pairs. Default is None.</span>
<span class="sd">                traj (object): The MDTraj trajectory. Default is None.</span>
<span class="sd">                frames (np.ndarray): The reference frames of the DNA structure. Default is None.</span>
<span class="sd">                chainids (list): The chain IDs. Default is None.</span>
<span class="sd">                circular (bool): A flag that indicates if the structure is circular/closed. Default is None.</span>

<span class="sd">            Raises:</span>
<span class="sd">                ValueError: If both traj and frames are provided.</span>
<span class="sd">                ValueError: If frames have an invalid shape.</span>
<span class="sd">                ValueError: If the number of base pairs in the sequence and frames do not match.</span>
<span class="sd">                ValueError: If neither traj nor frames are provided.</span>

<span class="sd">            Notes:</span>
<span class="sd">                - If traj is provided, sequence and n_bp will be extracted from the trajectory.</span>
<span class="sd">                - If frames is provided, n_bp will be determined from the shape of frames.</span>
<span class="sd">                - If sequence is provided, it will be checked against the number of base pairs.</span>

<span class="sd">            Attributes:</span>
<span class="sd">                sequence (str): The DNA sequence.</span>
<span class="sd">                n_bp (int): The number of base pairs.</span>
<span class="sd">                traj (object): The MDTraj trajectory.</span>
<span class="sd">                frames (np.ndarray): The reference frames of the DNA structure.</span>
<span class="sd">                chainids (list): The chain IDs.</span>
<span class="sd">                circular (bool): A flag that indicates if the structure is circular/closed.</span>
<span class="sd">                rigid (None): A container for rigid base parameters class output.</span>
<span class="sd">                minimizer (None): A container for minimizer class output.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># Check for trajectory</span>
            <span class="k">if</span> <span class="n">traj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">frames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide either a trajectory or reference frames, not both&#39;</span><span class="p">)</span>
                <span class="c1"># Extract sequence from the trajectory</span>
                <span class="n">sequence</span> <span class="o">=</span> <span class="n">get_sequence_letters</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">leading_chain</span><span class="o">=</span><span class="n">chainids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">n_bp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
                <span class="n">frames</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Nucleic class will handle extraction from traj</span>

            <span class="c1"># Check for reference frames</span>
            <span class="k">elif</span> <span class="n">frames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">frames</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="c1"># Case (n_bp, 4, 3)</span>
                    <span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">frames</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Frames should be of shape (n_bp, n_timesteps, 4, 3) or (n_bp, 4, 3)&#39;</span><span class="p">)</span>
                <span class="n">n_bp</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sequence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_bp</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of base pairs in the sequence and frames do not match&#39;</span><span class="p">)</span>  
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span> <span class="o">=</span> <span class="n">_check_input</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">)</span>      
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide either a trajectory or reference frames&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bp</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="n">frames</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chainids</span> <span class="o">=</span> <span class="n">chainids</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_circular</span><span class="p">()</span> <span class="k">if</span> <span class="n">circular</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">circular</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Container for rigid base parameters class output</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Container for minimizer class output</span>

    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print the DNA structure information&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;Circular &quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1">DNA structure with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bp</span><span class="si">}</span><span class="s1"> base pairs&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sequence:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Trajectory:&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Trajectory not loaded&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Frames: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Frames not loaded&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_frames_to_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert reference frames to trajectory&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Load reference frames first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="n">StructureGenerator</span><span class="p">(</span><span class="n">frames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[:,</span><span class="n">frame</span><span class="p">,:,:],</span> <span class="n">sequence</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_traj_to_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert trajectory to reference frames&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Load trajectory first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="o">=</span> <span class="n">NucleicFrames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chainids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rigid</span><span class="o">.</span><span class="n">frames</span>

    <span class="k">def</span> <span class="nf">get_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the reference frames of the DNA structure belonging to the base steps:</span>
<span class="sd">        Returns: array of reference frames of shape (n_frames, n_bp, 4, 3)</span>
<span class="sd">        where n_frames is the number of frames, n_bp is the number of base pairs, </span>
<span class="sd">        and 4 corresponds to the origin and the 3 vectors of the reference frame</span>

<span class="sd">        Returns:</span>
<span class="sd">            frames (np.ndarray): reference frames of the DNA structure&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span>

    <span class="k">def</span> <span class="nf">get_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the trajectory of the current state of the DNA structure</span>
<span class="sd">        Returns:</span>
<span class="sd">            MDtraj object&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">&gt;</span> <span class="mi">99999</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: Trajectory contains more than 99999 atoms, consider saving as .h5&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span>

    <span class="k">def</span> <span class="nf">get_rigid_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the rigid base parameters class object of the DNA structure</span>

<span class="sd">        Returns:</span>
<span class="sd">            NucleicFrames (object): Object representing the rigid base parameters of the DNA structure.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="o">=</span> <span class="n">NucleicFrames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chainids</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="o">=</span> <span class="n">NucleicFrames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chainids</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span>

    <span class="k">def</span> <span class="nf">_is_circular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect if the DNA structure is circular for a given chain and frame</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        chainid : int, optional</span>
<span class="sd">            ID of the chain to check, by default 0</span>
<span class="sd">        frame : int, optional</span>
<span class="sd">            Frame index to check, by default 0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            True if the DNA is circular, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>

        <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">start</span> <span class="o">-</span> <span class="n">end</span><span class="p">)</span>

        <span class="c1"># 0.34 nm is roughly the distance between base pairs and 20 is the minimum number of base pairs for circular DNA</span>
        <span class="k">return</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">20</span> 

    <span class="k">def</span> <span class="nf">_plot_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">traj</span><span class="p">,</span> <span class="n">chainid</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the DNA structure of a chain&quot;&quot;&quot;</span>
        <span class="n">phosphor</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;name P and chainid </span><span class="si">{</span><span class="n">chainid</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="n">phosphor</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="n">phosphor</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span> <span class="n">phosphor</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="c1"># Connect the last point to the first point</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_plot_helical_axis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">helical_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[:,</span><span class="n">frame</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">helical_axis</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">helical_axis</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">helical_axis</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="o">*</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">helical_axis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">helical_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],[</span><span class="n">helical_axis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">helical_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],[</span><span class="n">helical_axis</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">helical_axis</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="o">*</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">helical_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backbone</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lead</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">anti</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">triads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.23</span><span class="p">,</span><span class="n">color_lead</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">color_anti</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draws a 3D representation of the DNA structure with optional helical axis, backbone, lead, anti, and triads.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (object, optional): Matplotlib axis. Default is None.</span>
<span class="sd">            fig (object, optional): Figure axis. Default is None.</span>
<span class="sd">            save (bool, optional): Save image as png. Default is False.</span>
<span class="sd">            frame (int, optional): Index of trajectory to visualize. Default is -1.</span>
<span class="sd">            markersize (int, optional): Width of backbone plot. Default is 2.</span>
<span class="sd">            lw (int, optional): Line width of plots. Default is 1.</span>
<span class="sd">            helical_axis (bool, optional): Plot central axis passing through frame origins. Default is True.</span>
<span class="sd">            backbone (bool, optional): Plot backbone as &#39;o-&#39; line plot through phosphor atoms. Default is True.</span>
<span class="sd">            lead (bool, optional): Plot leading strand. Default is False.</span>
<span class="sd">            anti (bool, optional): Plot anti-sense opposing leading strand. Default is False.</span>
<span class="sd">            triads (bool, optional): Plot triads in order of b_L (blue), b_N (green), b_T (red). Default is False.</span>
<span class="sd">            length (float, optional): Length of triad vectors. Default is 0.23.</span>
<span class="sd">            color_lead (str, optional): Color of the leading strand. Default is &#39;k&#39;.</span>
<span class="sd">            color_anti (str, optional): Color of the anti strand. Default is &#39;darkgrey&#39;.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - The function draws a 3D representation of the DNA structure using matplotlib.</span>
<span class="sd">            - The DNA structure can include a helical axis, backbone, lead strand, anti-sense strand, and triads.</span>
<span class="sd">            - The function requires either the trajectory or reference frames to be loaded before calling.</span>

<span class="sd">        Example:</span>
<span class="sd">            nuc = Nucleic()</span>
<span class="sd">            nuc.load_traj(&#39;trajectory.dcd&#39;)</span>
<span class="sd">            nuc.draw(ax=plt.gca(), save=True, frame=10, markersize=3, lw=2, helical_axis=True, backbone=True, lead=True, anti=True, triads=True, length=0.2, color_lead=&#39;r&#39;, color_anti=&#39;b&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: handle circular DNA and when trajectory is not loaded make frames uniform </span>
        <span class="c1"># in shape (time/n_frames, n_bp, 4, 3)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">backbone</span><span class="p">:</span>
            <span class="n">lead</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">anti</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">lead</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_chain</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_lead</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">anti</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_chain</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_anti</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">helical_axis</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_helical_axis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">triads</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">triad</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span>
                <span class="n">triad</span> <span class="o">=</span> <span class="n">triad</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="n">markersize</span><span class="o">*</span><span class="mf">1.2</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dna.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">exvol_rad</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">temperature</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>  <span class="n">simple</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">equilibrate_writhe</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">endpoints_fixed</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fixed</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">dump_every</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Minimize the DNA structure. This method updates the  of the DNA structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame (int): The trajectory frame to minimize. Defaults to -1.</span>
<span class="sd">            simple (bool): Whether to use simple equilibration. Defaults to False.</span>
<span class="sd">            equilibrate_writhe (bool): Whether to equilibrate writhe. Defaults to False. Only works for simple equilibration.</span>
<span class="sd">            endpoints_fixed (bool): Whether the endpoints are fixed. Defaults to False.</span>
<span class="sd">            fixed (list): List of fixed base pairs. Defaults to an empty list.</span>
<span class="sd">            exvol_rad (float): Excluded volume radius. Defaults to 2.0.</span>
<span class="sd">            temperature (int): Temperature for equilibration. Defaults to 300.</span>
<span class="sd">            dump_every (int): Frequency of dumping frames. Defaults to 20.</span>

<span class="sd">        Additional keyword arguments can be provided and will be passed to the minimizer.</span>

<span class="sd">        Notes:</span>

<span class="sd">            For the simple equilibation, we rely on checking whether the considered quantity starts to fluctuate around a fixed value. </span>
<span class="sd">            This options is compatible with With the argument equilibrate_writhe, which you can specify that writhe should also be considered for equilibration. </span>

<span class="sd">            The other option is to use the full equilibration, which is based on the actual energy of the system.</span>
<span class="sd">            We assume the energy to converge exponentially to the equilibrated value.</span>
<span class="sd">            This works fairly well for most examples I checked but is not entirely robust. </span>
<span class="sd">            Considering autocorrelation has some issues when there are relaxations at different timescales.</span>
<span class="sd">            Also, I wasn&#39;t able to use something consistent to equilibrate writhe, since that involves a barrier crossing. </span>
<span class="sd">            It is really non-trivial to set a criterion for whether or not a globally stable value is reached. </span>

<span class="sd">        Example:</span>
<span class="sd">            nuc = load(traj)</span>
<span class="sd">            nuc.minimize(simple=True, temperature=310, exvol_rad=2.5)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">exvol_rad</span><span class="o">=</span><span class="n">exvol_rad</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="n">simple</span><span class="p">,</span> <span class="n">equilibrate_writhe</span><span class="o">=</span><span class="n">equilibrate_writhe</span><span class="p">,</span> <span class="n">endpoints_fixed</span><span class="o">=</span><span class="n">endpoints_fixed</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="n">fixed</span><span class="p">,</span> <span class="n">dump_every</span><span class="o">=</span><span class="n">dump_every</span><span class="p">)</span>    
        <span class="c1"># Update the reference frames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_MC_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the MC sampling energy minimization trajectory of the new spline.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Run minimization first&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">get_MC_traj</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mutations</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">complementary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mutate the DNA trajectory, updating the topology and coordinates of the DNA structure.</span>
<span class="sd">        The method updates the `traj` attribute and the `sequence` attribute of the DNA object.</span>


<span class="sd">        Args:</span>
<span class="sd">            mutations (dict, optional): A dictionary containing the mutation information. The keys represent the indices of the base pairs to be mutated, and the values represent the new nucleobases. For example, `mutations = {0: &#39;A&#39;, 1: &#39;T&#39;, 2: &#39;G&#39;}` will mutate the first three base pairs to A, T, and G, respectively. Defaults to None.</span>
<span class="sd">            complementary (bool, optional): Whether to mutate the complementary strand. Defaults to True.</span>
<span class="sd">            frame (int, optional): The frame to mutate. Defaults to -1.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If no mutation dictionary is provided.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - Valid nucleobases for mutations include:</span>
<span class="sd">                - Canonical bases: A, T, G, C, U</span>
<span class="sd">                - Hachimoji: B [A_ana], S [T_ana], P [C_ana], Z [G_ana] (DOI: 10.1126/science.aat0971)</span>
<span class="sd">                - Fluorescent: 2-aminopurine 2AP (E), triC (D) (DOI: 10.1002/anie.201001312), tricyclic cytosine base analogue (1tuq)</span>
<span class="sd">                - Hydrophobic pairs: d5SICS (L), dNaM (M)</span>

<span class="sd">        Examples:</span>
<span class="sd">            # Create a DNA object</span>
<span class="sd">            dna = DNA()</span>

<span class="sd">            # Mutate the DNA trajectory</span>
<span class="sd">            mutations = {0: &#39;A&#39;, 1: &#39;T&#39;, 2: &#39;G&#39;}</span>
<span class="sd">            dna.mutate(mutations=mutations, complementary=True, frame=-1)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mutations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide a mutation dictionary&#39;</span><span class="p">)</span>

        <span class="c1"># TODO: Check if valid letters in mutations dictionary</span>

        <span class="n">mutant</span> <span class="o">=</span> <span class="n">Mutate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="n">frame</span><span class="p">],</span> <span class="n">mutations</span><span class="p">,</span> <span class="n">complementary</span><span class="o">=</span><span class="n">complementary</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">mutant</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>
        <span class="c1"># Update sequence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_sequence_letters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="n">leading_chain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chainids</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>


    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fliplist</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">deg</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Flips the nucleobases of the DNA structure.</span>
<span class="sd">            The method updates the `traj` attribute of the DNA object.</span>


<span class="sd">            Args:</span>
<span class="sd">                fliplist (list): A list of base pairs to flip. Defaults to an empty list.</span>
<span class="sd">                deg (int): The degrees to flip. Defaults to 180.</span>
<span class="sd">                frame (int): The frame to flip. Defaults to -1.</span>

<span class="sd">            Raises:</span>
<span class="sd">                ValueError: If no fliplist is provided.</span>

<span class="sd">            Notes:</span>
<span class="sd">                This method flips the nucleobases of the DNA structure. It uses the Hoogsteen algorithm to perform the flipping.</span>
<span class="sd">                The `fliplist` parameter specifies the base pairs to flip. If no `fliplist` is provided, a `ValueError` is raised.</span>
<span class="sd">                The `deg` parameter specifies the degrees to flip. By default, it is set to 180 degrees.</span>
<span class="sd">                The `frame` parameter specifies the frame to flip. By default, it is set to -1.</span>

<span class="sd">            Example:</span>
<span class="sd">                &gt;&gt;&gt; dna = Nucleic()</span>
<span class="sd">                &gt;&gt;&gt; dna.flip(fliplist=[(1, 2), (3, 4)], deg=90, frame=0)</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fliplist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide a fliplist&#39;</span><span class="p">)</span>

            <span class="n">flipper</span> <span class="o">=</span> <span class="n">Hoogsteen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="n">fliplist</span><span class="o">=</span><span class="n">fliplist</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">flipper</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">methylate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methylations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">CpG</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">leading_strand</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Methylate the nucleobases of the DNA structure.</span>
<span class="sd">            The method updates the `traj` attribute of the DNA object.</span>


<span class="sd">            Args:</span>
<span class="sd">                methylations (list): List of base pairs to methylate. Defaults to [].</span>
<span class="sd">                CpG (bool): Whether to methylate CpG sites. Defaults to False.</span>
<span class="sd">                leading_strand (int): The leading strand to methylate. Defaults to 0.</span>
<span class="sd">                frame (int): The frame to methylate. Defaults to -1.</span>

<span class="sd">            Raises:</span>
<span class="sd">                ValueError: If the DNA structure is not loaded.</span>
<span class="sd">                ValueError: If the methylations list is empty.</span>

<span class="sd">            Notes:</span>
<span class="sd">                - If the DNA structure is not loaded, a ValueError will be raised.</span>
<span class="sd">                - If the methylations list is empty, a ValueError will be raised.</span>

<span class="sd">            Example:</span>
<span class="sd">                &gt;&gt;&gt; nuc = Nucleic()</span>
<span class="sd">                &gt;&gt;&gt; nuc.methylate(methylations=[1, 3, 5], CpG=True, leading_strand=1, frame=0)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;DNA structure is not loaded&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">methylations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide a non-empty methylations list&#39;</span><span class="p">)</span>

            <span class="n">methylator</span> <span class="o">=</span> <span class="n">Methylate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="n">methylations</span><span class="o">=</span><span class="n">methylations</span><span class="p">,</span> <span class="n">CpG</span><span class="o">=</span><span class="n">CpG</span><span class="p">,</span> <span class="n">leading_strand</span><span class="o">=</span><span class="n">leading_strand</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">methylator</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fixed_endpoints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">forward</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">margin</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">minimize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>  
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extend the DNA structure in the specified direction.</span>
<span class="sd">            The method updates the attributes of the DNA object.</span>


<span class="sd">        Args:</span>
<span class="sd">            n_bp (int): Number of base pairs to extend the DNA structure.</span>
<span class="sd">            sequence (str, optional): DNA sequence to extend the DNA structure. If not provided, the sequence will be generated randomly. Defaults to None.</span>
<span class="sd">            fixed_endpoints (bool, optional): Whether to fix the endpoints of the DNA structure during extension. Defaults to False.</span>
<span class="sd">            forward (bool, optional): Whether to extend the DNA structure in the forward direction. If False, the DNA structure will be extended in the backward direction. Defaults to True.</span>
<span class="sd">            frame (int, optional): The time frame to extend. Defaults to -1.</span>
<span class="sd">            shape (np.ndarray, optional): Control points of the shape to be used for extension. The shape should be a numpy array of shape (n, 3), where n is greater than 3. Defaults to None.</span>
<span class="sd">            margin (int, optional): Number of base pairs to fix at the end/start of the DNA structure during extension. Defaults to 1.</span>
<span class="sd">            minimize (bool, optional): Whether to minimize the new DNA structure after extension. Defaults to True.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the DNA structure is circular and cannot be extended.</span>
<span class="sd">            ValueError: If neither a fixed endpoint nor a length is specified for extension.</span>
<span class="sd">            ValueError: If the input sequence is invalid or the number of base pairs is invalid.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - If the DNA structure is circular, it cannot be extended.</span>
<span class="sd">            - If neither a fixed endpoint nor a length is specified for extension, a ValueError will be raised.</span>
<span class="sd">            - If the input sequence is provided, it will be used to extend the DNA structure. Otherwise, the sequence will be generated randomly.</span>
<span class="sd">            - If the shape is not provided, a straight line shape will be used for extension.</span>
<span class="sd">            - If the DNA structure is not in the form of frames, it will be converted to frames before extension.</span>
<span class="sd">            - If minimize is set to True, the new DNA structure will be minimized after extension.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nuc = Nucleic()</span>
<span class="sd">            &gt;&gt;&gt; nuc.extend(n_bp=10, sequence=&#39;ATCG&#39;, fixed_endpoints=True, forward=True, frame=-1, shape=None, margin=2, minimize=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot extend circular DNA structure&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">n_bp</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fixed_endpoints</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either a fixed endpoint or a length must be specified for extension.&quot;</span><span class="p">)</span>    
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">shape</span> <span class="o">=</span> <span class="n">Shapes</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>

        <span class="c1"># Check the input sequence and number of base pairs</span>
        <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span> <span class="o">=</span> <span class="n">_check_input</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">)</span>

        <span class="n">extender</span> <span class="o">=</span> <span class="n">Extender</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">fixed_endpoints</span><span class="o">=</span><span class="n">fixed_endpoints</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">)</span>
        <span class="c1"># Also update, n_bp, sequence, frames etc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span> <span class="o">=</span> <span class="n">extender</span><span class="o">.</span><span class="n">nuc</span>

        <span class="k">if</span> <span class="n">minimize</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">fixed</span><span class="o">=</span><span class="n">extender</span><span class="o">.</span><span class="n">fixed</span><span class="p">,</span> <span class="n">endpoints_fixed</span><span class="o">=</span><span class="n">fixed_endpoints</span><span class="p">)</span>

        <span class="c1"># Update attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">sequence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">get_frames</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_bp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">n_bp</span>

    <span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inverse the direction of the DNA structure so from 5&#39; to 3&#39; to 3&#39; to 5</span>
<span class="sd">         The method updates attributes of the DNA object.</span>

<span class="sd">         Raises:</span>
<span class="sd">            NotImplementedError.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Not implemented yet&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_linking_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the linking number of the DNA structure based on Gauss&#39;s linking number theorem.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame (int, optional): Time frame of trajectory, by default -1</span>

<span class="sd">        Returns:</span>
<span class="sd">            linking_number (np.ndarray): Numpy array containing the linking number, writhe, and twist corresponding to the time frame</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span> <span class="nn">pmcpy</span> <span class="kn">import</span> <span class="n">pylk</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[:,</span><span class="n">frame</span><span class="p">,:,:]</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">frames</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">triads</span> <span class="o">=</span> <span class="n">frames</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Flip row vectors to columns</span>

        <span class="n">writhe</span> <span class="o">=</span> <span class="n">pylk</span><span class="o">.</span><span class="n">writhe</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
        <span class="n">lk</span> <span class="o">=</span> <span class="n">pylk</span><span class="o">.</span><span class="n">triads2link</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">triads</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lk</span><span class="p">,</span> <span class="n">writhe</span><span class="p">,</span> <span class="n">lk</span> <span class="o">-</span> <span class="n">writhe</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">traj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Initializes the DNA structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DNA sequence, e.g. 'CGCGAATTCGCG'.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_bp</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of base pairs. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>traj</code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MDTraj trajectory. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frames</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reference frames of the DNA structure. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>chainids</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chain IDs. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>circular</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flag that indicates if the structure is circular/closed. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If both traj and frames are provided.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If frames have an invalid shape.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the number of base pairs in the sequence and frames do not match.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither traj nor frames are provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If traj is provided, sequence and n_bp will be extracted from the trajectory.</li>
<li>If frames is provided, n_bp will be determined from the shape of frames.</li>
<li>If sequence is provided, it will be checked against the number of base pairs.</li>
</ul>
</details>

<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.sequence">sequence</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DNA sequence.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.n_bp">n_bp</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of base pairs.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.traj">traj</span></code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The MDTraj trajectory.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.frames">frames</span></code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reference frames of the DNA structure.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.chainids">chainids</span></code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The chain IDs.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.circular">circular</span></code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A flag that indicates if the structure is circular/closed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.rigid">rigid</span></code></td>
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A container for rigid base parameters class output.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="pymdna.nucleic.Nucleic.__init__.minimizer">minimizer</span></code></td>
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A container for minimizer class output.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">traj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the DNA structure.</span>

<span class="sd">        Args:</span>
<span class="sd">            sequence (str): The DNA sequence, e.g. &#39;CGCGAATTCGCG&#39;.</span>
<span class="sd">            n_bp (int): The number of base pairs. Default is None.</span>
<span class="sd">            traj (object): The MDTraj trajectory. Default is None.</span>
<span class="sd">            frames (np.ndarray): The reference frames of the DNA structure. Default is None.</span>
<span class="sd">            chainids (list): The chain IDs. Default is None.</span>
<span class="sd">            circular (bool): A flag that indicates if the structure is circular/closed. Default is None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If both traj and frames are provided.</span>
<span class="sd">            ValueError: If frames have an invalid shape.</span>
<span class="sd">            ValueError: If the number of base pairs in the sequence and frames do not match.</span>
<span class="sd">            ValueError: If neither traj nor frames are provided.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - If traj is provided, sequence and n_bp will be extracted from the trajectory.</span>
<span class="sd">            - If frames is provided, n_bp will be determined from the shape of frames.</span>
<span class="sd">            - If sequence is provided, it will be checked against the number of base pairs.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            sequence (str): The DNA sequence.</span>
<span class="sd">            n_bp (int): The number of base pairs.</span>
<span class="sd">            traj (object): The MDTraj trajectory.</span>
<span class="sd">            frames (np.ndarray): The reference frames of the DNA structure.</span>
<span class="sd">            chainids (list): The chain IDs.</span>
<span class="sd">            circular (bool): A flag that indicates if the structure is circular/closed.</span>
<span class="sd">            rigid (None): A container for rigid base parameters class output.</span>
<span class="sd">            minimizer (None): A container for minimizer class output.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check for trajectory</span>
        <span class="k">if</span> <span class="n">traj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">frames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide either a trajectory or reference frames, not both&#39;</span><span class="p">)</span>
            <span class="c1"># Extract sequence from the trajectory</span>
            <span class="n">sequence</span> <span class="o">=</span> <span class="n">get_sequence_letters</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">leading_chain</span><span class="o">=</span><span class="n">chainids</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">n_bp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
            <span class="n">frames</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Nucleic class will handle extraction from traj</span>

        <span class="c1"># Check for reference frames</span>
        <span class="k">elif</span> <span class="n">frames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">frames</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="c1"># Case (n_bp, 4, 3)</span>
                <span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">frames</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Frames should be of shape (n_bp, n_timesteps, 4, 3) or (n_bp, 4, 3)&#39;</span><span class="p">)</span>
            <span class="n">n_bp</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">sequence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_bp</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of base pairs in the sequence and frames do not match&#39;</span><span class="p">)</span>  
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span> <span class="o">=</span> <span class="n">_check_input</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">)</span>      
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide either a trajectory or reference frames&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_bp</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="n">frames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chainids</span> <span class="o">=</span> <span class="n">chainids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_circular</span><span class="p">()</span> <span class="k">if</span> <span class="n">circular</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">circular</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Container for rigid base parameters class output</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># Container for minimizer class output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.describe" class="doc doc-heading">
            <code class=" language-python"><span class="n">describe</span><span class="p">()</span></code>

<a href="#pymdna.nucleic.Nucleic.describe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Print the DNA structure information</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the DNA structure information&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;Circular &quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1">DNA structure with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_bp</span><span class="si">}</span><span class="s1"> base pairs&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sequence:&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">))</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Trajectory:&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Trajectory not loaded&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Frames: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Frames not loaded&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.draw" class="doc doc-heading">
            <code class=" language-python"><span class="n">draw</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">helical_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backbone</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lead</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">anti</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">triads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.23</span><span class="p">,</span> <span class="n">color_lead</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">color_anti</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.draw" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Draws a 3D representation of the DNA structure with optional helical axis, backbone, lead, anti, and triads.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>ax</code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matplotlib axis. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fig</code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Figure axis. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>save</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Save image as png. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index of trajectory to visualize. Default is -1.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>markersize</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Width of backbone plot. Default is 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lw</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Line width of plots. Default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>helical_axis</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot central axis passing through frame origins. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>backbone</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot backbone as 'o-' line plot through phosphor atoms. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>lead</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot leading strand. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>anti</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot anti-sense opposing leading strand. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>triads</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Plot triads in order of b_L (blue), b_N (green), b_T (red). Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>length</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Length of triad vectors. Default is 0.23.</p>
              </div>
            </td>
            <td>
                  <code>0.23</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>color_lead</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the leading strand. Default is 'k'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;k&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>color_anti</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Color of the anti strand. Default is 'darkgrey'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;darkgrey&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The function draws a 3D representation of the DNA structure using matplotlib.</li>
<li>The DNA structure can include a helical axis, backbone, lead strand, anti-sense strand, and triads.</li>
<li>The function requires either the trajectory or reference frames to be loaded before calling.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>nuc = Nucleic()
nuc.load_traj('trajectory.dcd')
nuc.draw(ax=plt.gca(), save=True, frame=10, markersize=3, lw=2, helical_axis=True, backbone=True, lead=True, anti=True, triads=True, length=0.2, color_lead='r', color_anti='b')</p>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">helical_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backbone</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lead</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">anti</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">triads</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">0.23</span><span class="p">,</span><span class="n">color_lead</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">color_anti</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Draws a 3D representation of the DNA structure with optional helical axis, backbone, lead, anti, and triads.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (object, optional): Matplotlib axis. Default is None.</span>
<span class="sd">        fig (object, optional): Figure axis. Default is None.</span>
<span class="sd">        save (bool, optional): Save image as png. Default is False.</span>
<span class="sd">        frame (int, optional): Index of trajectory to visualize. Default is -1.</span>
<span class="sd">        markersize (int, optional): Width of backbone plot. Default is 2.</span>
<span class="sd">        lw (int, optional): Line width of plots. Default is 1.</span>
<span class="sd">        helical_axis (bool, optional): Plot central axis passing through frame origins. Default is True.</span>
<span class="sd">        backbone (bool, optional): Plot backbone as &#39;o-&#39; line plot through phosphor atoms. Default is True.</span>
<span class="sd">        lead (bool, optional): Plot leading strand. Default is False.</span>
<span class="sd">        anti (bool, optional): Plot anti-sense opposing leading strand. Default is False.</span>
<span class="sd">        triads (bool, optional): Plot triads in order of b_L (blue), b_N (green), b_T (red). Default is False.</span>
<span class="sd">        length (float, optional): Length of triad vectors. Default is 0.23.</span>
<span class="sd">        color_lead (str, optional): Color of the leading strand. Default is &#39;k&#39;.</span>
<span class="sd">        color_anti (str, optional): Color of the anti strand. Default is &#39;darkgrey&#39;.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The function draws a 3D representation of the DNA structure using matplotlib.</span>
<span class="sd">        - The DNA structure can include a helical axis, backbone, lead strand, anti-sense strand, and triads.</span>
<span class="sd">        - The function requires either the trajectory or reference frames to be loaded before calling.</span>

<span class="sd">    Example:</span>
<span class="sd">        nuc = Nucleic()</span>
<span class="sd">        nuc.load_traj(&#39;trajectory.dcd&#39;)</span>
<span class="sd">        nuc.draw(ax=plt.gca(), save=True, frame=10, markersize=3, lw=2, helical_axis=True, backbone=True, lead=True, anti=True, triads=True, length=0.2, color_lead=&#39;r&#39;, color_anti=&#39;b&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: handle circular DNA and when trajectory is not loaded make frames uniform </span>
    <span class="c1"># in shape (time/n_frames, n_bp, 4, 3)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">backbone</span><span class="p">:</span>
        <span class="n">lead</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">anti</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">lead</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_chain</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_lead</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">anti</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_chain</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="n">markersize</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_anti</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">helical_axis</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_helical_axis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">triads</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">triad</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span>
            <span class="n">triad</span> <span class="o">=</span> <span class="n">triad</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="n">markersize</span><span class="o">*</span><span class="mf">1.2</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">triad</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;dna.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.extend" class="doc doc-heading">
            <code class=" language-python"><span class="n">extend</span><span class="p">(</span><span class="n">n_bp</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fixed_endpoints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minimize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.extend" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Extend the DNA structure in the specified direction.
    The method updates the attributes of the DNA object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>n_bp</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of base pairs to extend the DNA structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA sequence to extend the DNA structure. If not provided, the sequence will be generated randomly. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed_endpoints</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to fix the endpoints of the DNA structure during extension. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>forward</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to extend the DNA structure in the forward direction. If False, the DNA structure will be extended in the backward direction. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time frame to extend. Defaults to -1.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shape</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control points of the shape to be used for extension. The shape should be a numpy array of shape (n, 3), where n is greater than 3. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>margin</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of base pairs to fix at the end/start of the DNA structure during extension. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>minimize</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to minimize the new DNA structure after extension. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the DNA structure is circular and cannot be extended.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If neither a fixed endpoint nor a length is specified for extension.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the input sequence is invalid or the number of base pairs is invalid.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If the DNA structure is circular, it cannot be extended.</li>
<li>If neither a fixed endpoint nor a length is specified for extension, a ValueError will be raised.</li>
<li>If the input sequence is provided, it will be used to extend the DNA structure. Otherwise, the sequence will be generated randomly.</li>
<li>If the shape is not provided, a straight line shape will be used for extension.</li>
<li>If the DNA structure is not in the form of frames, it will be converted to frames before extension.</li>
<li>If minimize is set to True, the new DNA structure will be minimized after extension.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>nuc = Nucleic()
nuc.extend(n_bp=10, sequence='ATCG', fixed_endpoints=True, forward=True, frame=-1, shape=None, margin=2, minimize=True)</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bp</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fixed_endpoints</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">forward</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">margin</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">minimize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>  
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extend the DNA structure in the specified direction.</span>
<span class="sd">        The method updates the attributes of the DNA object.</span>


<span class="sd">    Args:</span>
<span class="sd">        n_bp (int): Number of base pairs to extend the DNA structure.</span>
<span class="sd">        sequence (str, optional): DNA sequence to extend the DNA structure. If not provided, the sequence will be generated randomly. Defaults to None.</span>
<span class="sd">        fixed_endpoints (bool, optional): Whether to fix the endpoints of the DNA structure during extension. Defaults to False.</span>
<span class="sd">        forward (bool, optional): Whether to extend the DNA structure in the forward direction. If False, the DNA structure will be extended in the backward direction. Defaults to True.</span>
<span class="sd">        frame (int, optional): The time frame to extend. Defaults to -1.</span>
<span class="sd">        shape (np.ndarray, optional): Control points of the shape to be used for extension. The shape should be a numpy array of shape (n, 3), where n is greater than 3. Defaults to None.</span>
<span class="sd">        margin (int, optional): Number of base pairs to fix at the end/start of the DNA structure during extension. Defaults to 1.</span>
<span class="sd">        minimize (bool, optional): Whether to minimize the new DNA structure after extension. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the DNA structure is circular and cannot be extended.</span>
<span class="sd">        ValueError: If neither a fixed endpoint nor a length is specified for extension.</span>
<span class="sd">        ValueError: If the input sequence is invalid or the number of base pairs is invalid.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - If the DNA structure is circular, it cannot be extended.</span>
<span class="sd">        - If neither a fixed endpoint nor a length is specified for extension, a ValueError will be raised.</span>
<span class="sd">        - If the input sequence is provided, it will be used to extend the DNA structure. Otherwise, the sequence will be generated randomly.</span>
<span class="sd">        - If the shape is not provided, a straight line shape will be used for extension.</span>
<span class="sd">        - If the DNA structure is not in the form of frames, it will be converted to frames before extension.</span>
<span class="sd">        - If minimize is set to True, the new DNA structure will be minimized after extension.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; nuc = Nucleic()</span>
<span class="sd">        &gt;&gt;&gt; nuc.extend(n_bp=10, sequence=&#39;ATCG&#39;, fixed_endpoints=True, forward=True, frame=-1, shape=None, margin=2, minimize=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot extend circular DNA structure&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">n_bp</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fixed_endpoints</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either a fixed endpoint or a length must be specified for extension.&quot;</span><span class="p">)</span>    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">Shapes</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>

    <span class="c1"># Check the input sequence and number of base pairs</span>
    <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span> <span class="o">=</span> <span class="n">_check_input</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">)</span>

    <span class="n">extender</span> <span class="o">=</span> <span class="n">Extender</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">fixed_endpoints</span><span class="o">=</span><span class="n">fixed_endpoints</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">forward</span><span class="o">=</span><span class="n">forward</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">)</span>
    <span class="c1"># Also update, n_bp, sequence, frames etc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span> <span class="o">=</span> <span class="n">extender</span><span class="o">.</span><span class="n">nuc</span>

    <span class="k">if</span> <span class="n">minimize</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">fixed</span><span class="o">=</span><span class="n">extender</span><span class="o">.</span><span class="n">fixed</span><span class="p">,</span> <span class="n">endpoints_fixed</span><span class="o">=</span><span class="n">fixed_endpoints</span><span class="p">)</span>

    <span class="c1"># Update attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">sequence</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">get_frames</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_bp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nuc</span><span class="o">.</span><span class="n">n_bp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.flip" class="doc doc-heading">
            <code class=" language-python"><span class="n">flip</span><span class="p">(</span><span class="n">fliplist</span><span class="o">=</span><span class="p">[],</span> <span class="n">deg</span><span class="o">=</span><span class="mi">180</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.flip" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Flips the nucleobases of the DNA structure.
The method updates the <code>traj</code> attribute of the DNA object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>fliplist</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of base pairs to flip. Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>deg</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The degrees to flip. Defaults to 180.</p>
              </div>
            </td>
            <td>
                  <code>180</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frame to flip. Defaults to -1.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no fliplist is provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>This method flips the nucleobases of the DNA structure. It uses the Hoogsteen algorithm to perform the flipping.
The <code>fliplist</code> parameter specifies the base pairs to flip. If no <code>fliplist</code> is provided, a <code>ValueError</code> is raised.
The <code>deg</code> parameter specifies the degrees to flip. By default, it is set to 180 degrees.
The <code>frame</code> parameter specifies the frame to flip. By default, it is set to -1.</p>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>dna = Nucleic()
dna.flip(fliplist=[(1, 2), (3, 4)], deg=90, frame=0)</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fliplist</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">deg</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flips the nucleobases of the DNA structure.</span>
<span class="sd">        The method updates the `traj` attribute of the DNA object.</span>


<span class="sd">        Args:</span>
<span class="sd">            fliplist (list): A list of base pairs to flip. Defaults to an empty list.</span>
<span class="sd">            deg (int): The degrees to flip. Defaults to 180.</span>
<span class="sd">            frame (int): The frame to flip. Defaults to -1.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If no fliplist is provided.</span>

<span class="sd">        Notes:</span>
<span class="sd">            This method flips the nucleobases of the DNA structure. It uses the Hoogsteen algorithm to perform the flipping.</span>
<span class="sd">            The `fliplist` parameter specifies the base pairs to flip. If no `fliplist` is provided, a `ValueError` is raised.</span>
<span class="sd">            The `deg` parameter specifies the degrees to flip. By default, it is set to 180 degrees.</span>
<span class="sd">            The `frame` parameter specifies the frame to flip. By default, it is set to -1.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; dna = Nucleic()</span>
<span class="sd">            &gt;&gt;&gt; dna.flip(fliplist=[(1, 2), (3, 4)], deg=90, frame=0)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fliplist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide a fliplist&#39;</span><span class="p">)</span>

        <span class="n">flipper</span> <span class="o">=</span> <span class="n">Hoogsteen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="n">fliplist</span><span class="o">=</span><span class="n">fliplist</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">flipper</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.get_MC_traj" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_MC_traj</span><span class="p">()</span></code>

<a href="#pymdna.nucleic.Nucleic.get_MC_traj" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Get the MC sampling energy minimization trajectory of the new spline.</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_MC_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the MC sampling energy minimization trajectory of the new spline.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Run minimization first&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">get_MC_traj</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.get_frames" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_frames</span><span class="p">()</span></code>

<a href="#pymdna.nucleic.Nucleic.get_frames" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Get the reference frames of the DNA structure belonging to the base steps:
Returns: array of reference frames of shape (n_frames, n_bp, 4, 3)
where n_frames is the number of frames, n_bp is the number of base pairs, 
and 4 corresponds to the origin and the 3 vectors of the reference frame</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>frames</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>reference frames of the DNA structure</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the reference frames of the DNA structure belonging to the base steps:</span>
<span class="sd">    Returns: array of reference frames of shape (n_frames, n_bp, 4, 3)</span>
<span class="sd">    where n_frames is the number of frames, n_bp is the number of base pairs, </span>
<span class="sd">    and 4 corresponds to the origin and the 3 vectors of the reference frame</span>

<span class="sd">    Returns:</span>
<span class="sd">        frames (np.ndarray): reference frames of the DNA structure&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.get_linking_number" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_linking_number</span><span class="p">(</span><span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.get_linking_number" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Get the linking number of the DNA structure based on Gauss's linking number theorem.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time frame of trajectory, by default -1</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>linking_number</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array containing the linking number, writhe, and twist corresponding to the time frame</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_linking_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the linking number of the DNA structure based on Gauss&#39;s linking number theorem.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame (int, optional): Time frame of trajectory, by default -1</span>

<span class="sd">    Returns:</span>
<span class="sd">        linking_number (np.ndarray): Numpy array containing the linking number, writhe, and twist corresponding to the time frame</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">pmcpy</span> <span class="kn">import</span> <span class="n">pylk</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_traj_to_frames</span><span class="p">()</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[:,</span><span class="n">frame</span><span class="p">,:,:]</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">frames</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">triads</span> <span class="o">=</span> <span class="n">frames</span><span class="p">[:,</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># Flip row vectors to columns</span>

    <span class="n">writhe</span> <span class="o">=</span> <span class="n">pylk</span><span class="o">.</span><span class="n">writhe</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
    <span class="n">lk</span> <span class="o">=</span> <span class="n">pylk</span><span class="o">.</span><span class="n">triads2link</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">triads</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">lk</span><span class="p">,</span> <span class="n">writhe</span><span class="p">,</span> <span class="n">lk</span> <span class="o">-</span> <span class="n">writhe</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.get_rigid_parameters" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_rigid_parameters</span><span class="p">()</span></code>

<a href="#pymdna.nucleic.Nucleic.get_rigid_parameters" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Get the rigid base parameters class object of the DNA structure</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>NucleicFrames</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object representing the rigid base parameters of the DNA structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_rigid_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the rigid base parameters class object of the DNA structure</span>

<span class="sd">    Returns:</span>
<span class="sd">        NucleicFrames (object): Object representing the rigid base parameters of the DNA structure.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="o">=</span> <span class="n">NucleicFrames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chainids</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span> <span class="o">=</span> <span class="n">NucleicFrames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chainids</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.get_traj" class="doc doc-heading">
            <code class=" language-python"><span class="n">get_traj</span><span class="p">()</span></code>

<a href="#pymdna.nucleic.Nucleic.get_traj" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Get the trajectory of the current state of the DNA structure
Returns:
    MDtraj object</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the trajectory of the current state of the DNA structure</span>
<span class="sd">    Returns:</span>
<span class="sd">        MDtraj object&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="o">.</span><span class="n">n_atoms</span> <span class="o">&gt;</span> <span class="mi">99999</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning: Trajectory contains more than 99999 atoms, consider saving as .h5&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.invert" class="doc doc-heading">
            <code class=" language-python"><span class="n">invert</span><span class="p">()</span></code>

<a href="#pymdna.nucleic.Nucleic.invert" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Inverse the direction of the DNA structure so from 5' to 3' to 3' to 5
The method updates attributes of the DNA object.</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inverse the direction of the DNA structure so from 5&#39; to 3&#39; to 3&#39; to 5</span>
<span class="sd">     The method updates attributes of the DNA object.</span>

<span class="sd">     Raises:</span>
<span class="sd">        NotImplementedError.&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Not implemented yet&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.methylate" class="doc doc-heading">
            <code class=" language-python"><span class="n">methylate</span><span class="p">(</span><span class="n">methylations</span><span class="o">=</span><span class="p">[],</span> <span class="n">CpG</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">leading_strand</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.methylate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Methylate the nucleobases of the DNA structure.
The method updates the <code>traj</code> attribute of the DNA object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>methylations</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of base pairs to methylate. Defaults to [].</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>CpG</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to methylate CpG sites. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>leading_strand</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The leading strand to methylate. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frame to methylate. Defaults to -1.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the DNA structure is not loaded.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the methylations list is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If the DNA structure is not loaded, a ValueError will be raised.</li>
<li>If the methylations list is empty, a ValueError will be raised.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>nuc = Nucleic()
nuc.methylate(methylations=[1, 3, 5], CpG=True, leading_strand=1, frame=0)</p>
</blockquote>
</blockquote>
</blockquote>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">methylate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">methylations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">CpG</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">leading_strand</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Methylate the nucleobases of the DNA structure.</span>
<span class="sd">        The method updates the `traj` attribute of the DNA object.</span>


<span class="sd">        Args:</span>
<span class="sd">            methylations (list): List of base pairs to methylate. Defaults to [].</span>
<span class="sd">            CpG (bool): Whether to methylate CpG sites. Defaults to False.</span>
<span class="sd">            leading_strand (int): The leading strand to methylate. Defaults to 0.</span>
<span class="sd">            frame (int): The frame to methylate. Defaults to -1.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the DNA structure is not loaded.</span>
<span class="sd">            ValueError: If the methylations list is empty.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - If the DNA structure is not loaded, a ValueError will be raised.</span>
<span class="sd">            - If the methylations list is empty, a ValueError will be raised.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; nuc = Nucleic()</span>
<span class="sd">            &gt;&gt;&gt; nuc.methylate(methylations=[1, 3, 5], CpG=True, leading_strand=1, frame=0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;DNA structure is not loaded&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">methylations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide a non-empty methylations list&#39;</span><span class="p">)</span>

        <span class="n">methylator</span> <span class="o">=</span> <span class="n">Methylate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="n">methylations</span><span class="o">=</span><span class="n">methylations</span><span class="p">,</span> <span class="n">CpG</span><span class="o">=</span><span class="n">CpG</span><span class="p">,</span> <span class="n">leading_strand</span><span class="o">=</span><span class="n">leading_strand</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">methylator</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.minimize" class="doc doc-heading">
            <code class=" language-python"><span class="n">minimize</span><span class="p">(</span><span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">exvol_rad</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equilibrate_writhe</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">endpoints_fixed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="p">[],</span> <span class="n">dump_every</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.minimize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Minimize the DNA structure. This method updates the  of the DNA structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The trajectory frame to minimize. Defaults to -1.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>simple</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to use simple equilibration. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>equilibrate_writhe</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to equilibrate writhe. Defaults to False. Only works for simple equilibration.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>endpoints_fixed</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the endpoints are fixed. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>fixed</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of fixed base pairs. Defaults to an empty list.</p>
              </div>
            </td>
            <td>
                  <code>[]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exvol_rad</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Excluded volume radius. Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>temperature</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature for equilibration. Defaults to 300.</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dump_every</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Frequency of dumping frames. Defaults to 20.</p>
              </div>
            </td>
            <td>
                  <code>20</code>
            </td>
          </tr>
      </tbody>
    </table>
      <p>Additional keyword arguments can be provided and will be passed to the minimizer.</p>
<p>Notes:</p>
<div class="codehilite"><pre><span></span><code><span class="nx">For</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">simple</span><span class="w"> </span><span class="nx">equilibation</span><span class="p">,</span><span class="w"> </span><span class="nx">we</span><span class="w"> </span><span class="nx">rely</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">checking</span><span class="w"> </span><span class="nx">whether</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">considered</span><span class="w"> </span><span class="nx">quantity</span><span class="w"> </span><span class="nx">starts</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">fluctuate</span><span class="w"> </span><span class="nx">around</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">fixed</span><span class="w"> </span><span class="nx">value</span><span class="p">.</span><span class="w"> </span>
<span class="nx">This</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">compatible</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">With</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">argument</span><span class="w"> </span><span class="nx">equilibrate_writhe</span><span class="p">,</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="nx">you</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">specify</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">writhe</span><span class="w"> </span><span class="nx">should</span><span class="w"> </span><span class="nx">also</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">considered</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">equilibration</span><span class="p">.</span>

<span class="nx">The</span><span class="w"> </span><span class="nx">other</span><span class="w"> </span><span class="nx">option</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">full</span><span class="w"> </span><span class="nx">equilibration</span><span class="p">,</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">based</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">actual</span><span class="w"> </span><span class="nx">energy</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">system</span><span class="p">.</span>
<span class="nx">We</span><span class="w"> </span><span class="nx">assume</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">energy</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">converge</span><span class="w"> </span><span class="nx">exponentially</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">equilibrated</span><span class="w"> </span><span class="nx">value</span><span class="p">.</span>
<span class="nx">This</span><span class="w"> </span><span class="nx">works</span><span class="w"> </span><span class="nx">fairly</span><span class="w"> </span><span class="nx">well</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">most</span><span class="w"> </span><span class="nx">examples</span><span class="w"> </span><span class="nx">I</span><span class="w"> </span><span class="nx">checked</span><span class="w"> </span><span class="nx">but</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">entirely</span><span class="w"> </span><span class="nx">robust</span><span class="p">.</span><span class="w"> </span>
<span class="nx">Considering</span><span class="w"> </span><span class="nx">autocorrelation</span><span class="w"> </span><span class="nx">has</span><span class="w"> </span><span class="nx">some</span><span class="w"> </span><span class="nx">issues</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">there</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">relaxations</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">different</span><span class="w"> </span><span class="nx">timescales</span><span class="p">.</span>
<span class="nx">Also</span><span class="p">,</span><span class="w"> </span><span class="nx">I</span><span class="w"> </span><span class="nx">wasn</span><span class="err">&#39;</span><span class="nx">t</span><span class="w"> </span><span class="nx">able</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">something</span><span class="w"> </span><span class="nx">consistent</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">equilibrate</span><span class="w"> </span><span class="nx">writhe</span><span class="p">,</span><span class="w"> </span><span class="nx">since</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">involves</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">barrier</span><span class="w"> </span><span class="nx">crossing</span><span class="p">.</span><span class="w"> </span>
<span class="nx">It</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">really</span><span class="w"> </span><span class="nx">non</span><span class="o">-</span><span class="nx">trivial</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">criterion</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">whether</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">globally</span><span class="w"> </span><span class="nx">stable</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">reached</span><span class="p">.</span>
</code></pre></div>


<details class="example" open>
  <summary>Example</summary>
  <p>nuc = load(traj)
nuc.minimize(simple=True, temperature=310, exvol_rad=2.5)</p>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">exvol_rad</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">temperature</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span>  <span class="n">simple</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">equilibrate_writhe</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">endpoints_fixed</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fixed</span> <span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">dump_every</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Minimize the DNA structure. This method updates the  of the DNA structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame (int): The trajectory frame to minimize. Defaults to -1.</span>
<span class="sd">        simple (bool): Whether to use simple equilibration. Defaults to False.</span>
<span class="sd">        equilibrate_writhe (bool): Whether to equilibrate writhe. Defaults to False. Only works for simple equilibration.</span>
<span class="sd">        endpoints_fixed (bool): Whether the endpoints are fixed. Defaults to False.</span>
<span class="sd">        fixed (list): List of fixed base pairs. Defaults to an empty list.</span>
<span class="sd">        exvol_rad (float): Excluded volume radius. Defaults to 2.0.</span>
<span class="sd">        temperature (int): Temperature for equilibration. Defaults to 300.</span>
<span class="sd">        dump_every (int): Frequency of dumping frames. Defaults to 20.</span>

<span class="sd">    Additional keyword arguments can be provided and will be passed to the minimizer.</span>

<span class="sd">    Notes:</span>

<span class="sd">        For the simple equilibation, we rely on checking whether the considered quantity starts to fluctuate around a fixed value. </span>
<span class="sd">        This options is compatible with With the argument equilibrate_writhe, which you can specify that writhe should also be considered for equilibration. </span>

<span class="sd">        The other option is to use the full equilibration, which is based on the actual energy of the system.</span>
<span class="sd">        We assume the energy to converge exponentially to the equilibrated value.</span>
<span class="sd">        This works fairly well for most examples I checked but is not entirely robust. </span>
<span class="sd">        Considering autocorrelation has some issues when there are relaxations at different timescales.</span>
<span class="sd">        Also, I wasn&#39;t able to use something consistent to equilibrate writhe, since that involves a barrier crossing. </span>
<span class="sd">        It is really non-trivial to set a criterion for whether or not a globally stable value is reached. </span>

<span class="sd">    Example:</span>
<span class="sd">        nuc = load(traj)</span>
<span class="sd">        nuc.minimize(simple=True, temperature=310, exvol_rad=2.5)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span> <span class="o">=</span> <span class="n">Minimizer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">minimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">exvol_rad</span><span class="o">=</span><span class="n">exvol_rad</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">simple</span><span class="o">=</span><span class="n">simple</span><span class="p">,</span> <span class="n">equilibrate_writhe</span><span class="o">=</span><span class="n">equilibrate_writhe</span><span class="p">,</span> <span class="n">endpoints_fixed</span><span class="o">=</span><span class="n">endpoints_fixed</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="n">fixed</span><span class="p">,</span> <span class="n">dump_every</span><span class="o">=</span><span class="n">dump_every</span><span class="p">)</span>    
    <span class="c1"># Update the reference frames</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pymdna.nucleic.Nucleic.mutate" class="doc doc-heading">
            <code class=" language-python"><span class="n">mutate</span><span class="p">(</span><span class="n">mutations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">complementary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.Nucleic.mutate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

      <p>Mutate the DNA trajectory, updating the topology and coordinates of the DNA structure.
The method updates the <code>traj</code> attribute and the <code>sequence</code> attribute of the DNA object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>mutations</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing the mutation information. The keys represent the indices of the base pairs to be mutated, and the values represent the new nucleobases. For example, <code>mutations = {0: 'A', 1: 'T', 2: 'G'}</code> will mutate the first three base pairs to A, T, and G, respectively. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>complementary</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to mutate the complementary strand. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The frame to mutate. Defaults to -1.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If no mutation dictionary is provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>Valid nucleobases for mutations include:<ul>
<li>Canonical bases: A, T, G, C, U</li>
<li>Hachimoji: B [A_ana], S [T_ana], P [C_ana], Z [G_ana] (DOI: 10.1126/science.aat0971)</li>
<li>Fluorescent: 2-aminopurine 2AP (E), triC (D) (DOI: 10.1002/anie.201001312), tricyclic cytosine base analogue (1tuq)</li>
<li>Hydrophobic pairs: d5SICS (L), dNaM (M)</li>
</ul>
</li>
</ul>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <h4 id="pymdna.nucleic.Nucleic.mutate--create-a-dna-object">Create a DNA object<a class="headerlink" href="#pymdna.nucleic.Nucleic.mutate--create-a-dna-object" title="Permanent link">&para;</a></h4>
<p>dna = DNA()</p>
<h4 id="pymdna.nucleic.Nucleic.mutate--mutate-the-dna-trajectory">Mutate the DNA trajectory<a class="headerlink" href="#pymdna.nucleic.Nucleic.mutate--mutate-the-dna-trajectory" title="Permanent link">&para;</a></h4>
<p>mutations = {0: 'A', 1: 'T', 2: 'G'}
dna.mutate(mutations=mutations, complementary=True, frame=-1)</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mutations</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">complementary</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mutate the DNA trajectory, updating the topology and coordinates of the DNA structure.</span>
<span class="sd">    The method updates the `traj` attribute and the `sequence` attribute of the DNA object.</span>


<span class="sd">    Args:</span>
<span class="sd">        mutations (dict, optional): A dictionary containing the mutation information. The keys represent the indices of the base pairs to be mutated, and the values represent the new nucleobases. For example, `mutations = {0: &#39;A&#39;, 1: &#39;T&#39;, 2: &#39;G&#39;}` will mutate the first three base pairs to A, T, and G, respectively. Defaults to None.</span>
<span class="sd">        complementary (bool, optional): Whether to mutate the complementary strand. Defaults to True.</span>
<span class="sd">        frame (int, optional): The frame to mutate. Defaults to -1.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If no mutation dictionary is provided.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - Valid nucleobases for mutations include:</span>
<span class="sd">            - Canonical bases: A, T, G, C, U</span>
<span class="sd">            - Hachimoji: B [A_ana], S [T_ana], P [C_ana], Z [G_ana] (DOI: 10.1126/science.aat0971)</span>
<span class="sd">            - Fluorescent: 2-aminopurine 2AP (E), triC (D) (DOI: 10.1002/anie.201001312), tricyclic cytosine base analogue (1tuq)</span>
<span class="sd">            - Hydrophobic pairs: d5SICS (L), dNaM (M)</span>

<span class="sd">    Examples:</span>
<span class="sd">        # Create a DNA object</span>
<span class="sd">        dna = DNA()</span>

<span class="sd">        # Mutate the DNA trajectory</span>
<span class="sd">        mutations = {0: &#39;A&#39;, 1: &#39;T&#39;, 2: &#39;G&#39;}</span>
<span class="sd">        dna.mutate(mutations=mutations, complementary=True, frame=-1)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_frames_to_traj</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">mutations</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Provide a mutation dictionary&#39;</span><span class="p">)</span>

    <span class="c1"># TODO: Check if valid letters in mutations dictionary</span>

    <span class="n">mutant</span> <span class="o">=</span> <span class="n">Mutate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">[</span><span class="n">frame</span><span class="p">],</span> <span class="n">mutations</span><span class="p">,</span> <span class="n">complementary</span><span class="o">=</span><span class="n">complementary</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">traj</span> <span class="o">=</span> <span class="n">mutant</span><span class="o">.</span><span class="n">get_traj</span><span class="p">()</span>
    <span class="c1"># Update sequence</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_sequence_letters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">traj</span><span class="p">,</span> <span class="n">leading_chain</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chainids</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.compute_curvature" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_curvature</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span></code>

<a href="#pymdna.nucleic.compute_curvature" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Compute the curvature of the DNA structure</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_curvature</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the curvature of the DNA structure&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.compute_groove_width" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_groove_width</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span></code>

<a href="#pymdna.nucleic.compute_groove_width" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Compute the groove width of the DNA structure</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_groove_width</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the groove width of the DNA structure&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.compute_linking_number" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_linking_number</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span></code>

<a href="#pymdna.nucleic.compute_linking_number" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Compute the linking number of the DNA structure</p>

            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_linking_number</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the linking number of the DNA structure&quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.compute_rigid_parameters" class="doc doc-heading">
            <code class=" language-python"><span class="n">compute_rigid_parameters</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span></code>

<a href="#pymdna.nucleic.compute_rigid_parameters" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Compute the rigid base parameters of the DNA structure.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>traj</code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MDtraj trajectory containing the DNA structure.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>chainids</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of chain IDs of the DNA structure. Default is [0, 1].</p>
              </div>
            </td>
            <td>
                  <code>[0, 1]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>NucleicFrames</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object representing the rigid base parameters of the DNA structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the traj argument is not provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The traj argument must be provided.</li>
<li>The chainids argument is optional and defaults to [0, 1].</li>
<li>The returned NucleicFrames object contains information about the rigid base parameters of the DNA structure, such as the positions and orientations of the base steps.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <h3 id="pymdna.nucleic.compute_rigid_parameters--compute-the-rigid-base-parameters-of-a-dna-structure">Compute the rigid base parameters of a DNA structure<a class="headerlink" href="#pymdna.nucleic.compute_rigid_parameters--compute-the-rigid-base-parameters-of-a-dna-structure" title="Permanent link">&para;</a></h3>
<p>traj = md.load('dna.pdb')
rigid_params = compute_rigid_parameters(traj, chainids=[0, 1])</p>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">compute_rigid_parameters</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the rigid base parameters of the DNA structure.</span>

<span class="sd">    Args:</span>
<span class="sd">        traj (object): MDtraj trajectory containing the DNA structure.</span>
<span class="sd">        chainids (list, optional): List of chain IDs of the DNA structure. Default is [0, 1].</span>

<span class="sd">    Returns:</span>
<span class="sd">        NucleicFrames (object): Object representing the rigid base parameters of the DNA structure.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the traj argument is not provided.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The traj argument must be provided.</span>
<span class="sd">        - The chainids argument is optional and defaults to [0, 1].</span>
<span class="sd">        - The returned NucleicFrames object contains information about the rigid base parameters of the DNA structure, such as the positions and orientations of the base steps.</span>

<span class="sd">    Example:</span>
<span class="sd">        # Compute the rigid base parameters of a DNA structure</span>
<span class="sd">        traj = md.load(&#39;dna.pdb&#39;)</span>
<span class="sd">        rigid_params = compute_rigid_parameters(traj, chainids=[0, 1])&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">traj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The traj argument must be provided.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">NucleicFrames</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">chainids</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.connect" class="doc doc-heading">
            <code class=" language-python"><span class="n">connect</span><span class="p">(</span><span class="n">Nucleic0</span><span class="p">,</span> <span class="n">Nucleic1</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">leader</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minimize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exvol_rad</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.connect" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Connect two DNA structures by creating a new DNA structure with a connecting DNA strand.</p>
<p>The 3' end of the first DNA structure is connected to the 5' end of the second DNA structure.
To connect the two strands, a straight line is interpolated between the two ends,
and the optimal number of base pairs is distributed to achieve a neutral twist.</p>
<p>Note:
The minimization does not use excluded volume interactions by default.
This is because the excluded volume interactions require the EV beads to have no overlap.
However, in the initial configuration, the EV beads are likely to have overlap.
If desired, the resulting Nucleic object can be further minimized with the excluded volume interactions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>Nucleic0</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pymdna.nucleic.Nucleic" href="#pymdna.nucleic.Nucleic">Nucleic</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First DNA structure to connect.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>Nucleic1</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="pymdna.nucleic.Nucleic" href="#pymdna.nucleic.Nucleic">Nucleic</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second DNA structure to connect.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA sequence of the connecting DNA strand. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_bp</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of base pairs of the connecting DNA strand. Default is None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>leader</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The leader of the DNA structure to connect. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frame</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The time frame to connect. Default is -1.</p>
              </div>
            </td>
            <td>
                  <code>-1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>margin</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of base pairs to fix at the end. Default is 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>minimize</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to minimize the new DNA structure. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>exvol_rad</code></td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius for excluded volume interactions during minimization. Default is 0.0.</p>
              </div>
            </td>
            <td>
                  <code>0.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>temperature</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature for minimization. Default is 300.</p>
              </div>
            </td>
            <td>
                  <code>300</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Nucleic</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA structure with the two DNA structures connected.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If either of the DNA structures is circular.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h3 id="pymdna.nucleic.connect--connect-two-dna-structures">Connect two DNA structures<a class="headerlink" href="#pymdna.nucleic.connect--connect-two-dna-structures" title="Permanent link">&para;</a></h3>
<p>connected_dna = connect(Nucleic0, Nucleic1, sequence='ATCG', n_bp=4, leader=0, frame=-1, margin=2, minimize=True, exvol_rad=0.5, temperature=310)</p>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="n">Nucleic0</span><span class="p">,</span> <span class="n">Nucleic1</span><span class="p">,</span> <span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">leader</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">margin</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">minimize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">exvol_rad</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Connect two DNA structures by creating a new DNA structure with a connecting DNA strand.</span>

<span class="sd">    The 3&#39; end of the first DNA structure is connected to the 5&#39; end of the second DNA structure.</span>
<span class="sd">    To connect the two strands, a straight line is interpolated between the two ends,</span>
<span class="sd">    and the optimal number of base pairs is distributed to achieve a neutral twist.</span>

<span class="sd">    Note:</span>
<span class="sd">    The minimization does not use excluded volume interactions by default.</span>
<span class="sd">    This is because the excluded volume interactions require the EV beads to have no overlap.</span>
<span class="sd">    However, in the initial configuration, the EV beads are likely to have overlap.</span>
<span class="sd">    If desired, the resulting Nucleic object can be further minimized with the excluded volume interactions.</span>

<span class="sd">    Args:</span>
<span class="sd">        Nucleic0 (Nucleic): First DNA structure to connect.</span>
<span class="sd">        Nucleic1 (Nucleic): Second DNA structure to connect.</span>
<span class="sd">        sequence (str, optional): DNA sequence of the connecting DNA strand. Default is None.</span>
<span class="sd">        n_bp (int, optional): Number of base pairs of the connecting DNA strand. Default is None.</span>
<span class="sd">        leader (int, optional): The leader of the DNA structure to connect. Default is 0.</span>
<span class="sd">        frame (int, optional): The time frame to connect. Default is -1.</span>
<span class="sd">        margin (int, optional): Number of base pairs to fix at the end. Default is 1.</span>
<span class="sd">        minimize (bool, optional): Whether to minimize the new DNA structure. Default is True.</span>
<span class="sd">        exvol_rad (float, optional): Radius for excluded volume interactions during minimization. Default is 0.0.</span>
<span class="sd">        temperature (int, optional): Temperature for minimization. Default is 300.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Nucleic (object): DNA structure with the two DNA structures connected.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If either of the DNA structures is circular.</span>

<span class="sd">    Example:</span>
<span class="sd">        # Connect two DNA structures</span>
<span class="sd">        connected_dna = connect(Nucleic0, Nucleic1, sequence=&#39;ATCG&#39;, n_bp=4, leader=0, frame=-1, margin=2, minimize=True, exvol_rad=0.5, temperature=310)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">Nucleic0</span><span class="o">.</span><span class="n">circular</span> <span class="ow">or</span> <span class="n">Nucleic1</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot connect circular DNA structures&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sequence</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_bp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n_bp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>

    <span class="c1"># Connect the two DNA structures</span>
    <span class="n">connector</span> <span class="o">=</span> <span class="n">Connector</span><span class="p">(</span><span class="n">Nucleic0</span><span class="p">,</span> <span class="n">Nucleic1</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">,</span> <span class="n">leader</span><span class="o">=</span><span class="n">leader</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="n">frame</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">minimize</span><span class="p">:</span>
        <span class="n">connector</span><span class="o">.</span><span class="n">connected_nuc</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">exvol_rad</span><span class="o">=</span><span class="n">exvol_rad</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="n">connector</span><span class="o">.</span><span class="n">fixed</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">connector</span><span class="o">.</span><span class="n">connected_nuc</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.load" class="doc doc-heading">
            <code class=" language-python"><span class="n">load</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">circular</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.load" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Load DNA representation from either base step mean reference frames/spline frames or an MDtraj trajectory.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>traj</code></td>
            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MDtraj trajectory containing the DNA structure. If provided, the frames and sequence arguments are ignored. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>frames</code></td>
            <td>
                  <code><span title="numpy.array">array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base step mean reference frames of shape (n_bp, n_timesteps, 4, 3) or (n_bp, 4, 3). If provided, the traj and sequence arguments are ignored. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA sequence. If provided, the traj and frames arguments are ignored. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>chainids</code></td>
            <td>
                  <code>list</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Chain IDs of the DNA structure. (default: [0,1])</p>
              </div>
            </td>
            <td>
                  <code>[0, 1]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>circular</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating if the DNA structure is circular/closed. If not provided, it will be determined based on the input data. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Nucleic</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA structure object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If traj is provided, the frames and sequence arguments are ignored.</li>
<li>If frames is provided, the traj and sequence arguments are ignored.</li>
<li>If sequence is provided, the traj and frames arguments are ignored.</li>
<li>If circular is not provided, it will be determined based on the input data.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="n">traj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">circular</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load DNA representation from either base step mean reference frames/spline frames or an MDtraj trajectory.</span>

<span class="sd">    Args:</span>
<span class="sd">        traj (object, optional): MDtraj trajectory containing the DNA structure. If provided, the frames and sequence arguments are ignored. (default: None)</span>
<span class="sd">        frames (np.array, optional): Base step mean reference frames of shape (n_bp, n_timesteps, 4, 3) or (n_bp, 4, 3). If provided, the traj and sequence arguments are ignored. (default: None)</span>
<span class="sd">        sequence (str, optional): DNA sequence. If provided, the traj and frames arguments are ignored. (default: None)</span>
<span class="sd">        chainids (list, optional): Chain IDs of the DNA structure. (default: [0,1])</span>
<span class="sd">        circular (bool, optional): Flag indicating if the DNA structure is circular/closed. If not provided, it will be determined based on the input data. (default: None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Nucleic (object): DNA structure object.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - If traj is provided, the frames and sequence arguments are ignored.</span>
<span class="sd">        - If frames is provided, the traj and sequence arguments are ignored.</span>
<span class="sd">        - If sequence is provided, the traj and frames arguments are ignored.</span>
<span class="sd">        - If circular is not provided, it will be determined based on the input data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Nucleic</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">traj</span><span class="o">=</span><span class="n">traj</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="n">chainids</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.make" class="doc doc-heading">
            <code class=" language-python"><span class="n">make</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">control_points</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dLk</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.make" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Generate a DNA structure from a given DNA sequence and control points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA sequence code. If not provided, the default sequence 'CGCGAATTCGCG' will be used. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>control_points</code></td>
            <td>
                  <code>ndarray</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control points of the DNA structure. Should be a numpy array of shape (n, 3) where n is the number of control points. If not provided, a straight line will be used as the default control points. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>circular</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating if the DNA structure is circular/closed. If True, the DNA structure will be closed. If False, the DNA structure will be open. (default: False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>closed</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating if the DNA structure is closed. If True, the DNA structure will be closed. If False, the DNA structure will be open. This argument is deprecated and will be removed in a future version. Please use the 'circular' argument instead. (default: False)</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_bp</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of base pairs to scale the shape with. If not provided, the number of base pairs will be determined based on the length of the control points or the sequence. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dLk</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Change in twist in terms of Linking number of the DNA structure. If not provided, a neutral twist based on bp_per_turn = 10.5 will be used. (default: None)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Nucleic</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA structure object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>If control_points are provided, the sequence argument is ignored.</li>
<li>If sequence is provided, the control_points argument is ignored.</li>
<li>If circular is True, the DNA structure will be closed.</li>
<li>If circular is False, the DNA structure will be open.</li>
<li>The closed argument is deprecated and will be removed in a future version. Please use the 'circular' argument instead.</li>
</ul>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">control_points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">circular</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">closed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">n_bp</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dLk</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a DNA structure from a given DNA sequence and control points.</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence (str, optional): DNA sequence code. If not provided, the default sequence &#39;CGCGAATTCGCG&#39; will be used. (default: None)</span>
<span class="sd">        control_points (ndarray, optional): Control points of the DNA structure. Should be a numpy array of shape (n, 3) where n is the number of control points. If not provided, a straight line will be used as the default control points. (default: None)</span>
<span class="sd">        circular (bool, optional): Flag indicating if the DNA structure is circular/closed. If True, the DNA structure will be closed. If False, the DNA structure will be open. (default: False)</span>
<span class="sd">        closed (bool, optional): Flag indicating if the DNA structure is closed. If True, the DNA structure will be closed. If False, the DNA structure will be open. This argument is deprecated and will be removed in a future version. Please use the &#39;circular&#39; argument instead. (default: False)</span>
<span class="sd">        n_bp (int, optional): Number of base pairs to scale the shape with. If not provided, the number of base pairs will be determined based on the length of the control points or the sequence. (default: None)</span>
<span class="sd">        dLk (int, optional): Change in twist in terms of Linking number of the DNA structure. If not provided, a neutral twist based on bp_per_turn = 10.5 will be used. (default: None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Nucleic (object): DNA structure object.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - If control_points are provided, the sequence argument is ignored.</span>
<span class="sd">        - If sequence is provided, the control_points argument is ignored.</span>
<span class="sd">        - If circular is True, the DNA structure will be closed.</span>
<span class="sd">        - If circular is False, the DNA structure will be open.</span>
<span class="sd">        - The closed argument is deprecated and will be removed in a future version. Please use the &#39;circular&#39; argument instead.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check if control points are provided, otherwise generate a straight line</span>
    <span class="k">if</span> <span class="n">control_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Control points should contain at least 4 points [x, y, z]&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">n_bp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n_bp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">control_points</span><span class="p">)</span>  <span class="c1"># Number of base pairs</span>
    <span class="k">elif</span> <span class="n">control_points</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">circular</span><span class="p">:</span>
        <span class="n">control_points</span> <span class="o">=</span> <span class="n">Shapes</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">closed</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Linear strand of control points</span>
        <span class="n">control_points</span> <span class="o">=</span> <span class="n">Shapes</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span> <span class="o">=</span> <span class="n">_check_input</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">)</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">SplineFrames</span><span class="p">(</span><span class="n">control_points</span><span class="o">=</span><span class="n">control_points</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">circular</span><span class="p">,</span> <span class="n">dLk</span><span class="o">=</span><span class="n">dLk</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Nucleic</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">,</span> <span class="n">frames</span><span class="o">=</span><span class="n">spline</span><span class="o">.</span><span class="n">frames</span><span class="p">,</span> <span class="n">chainids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">circular</span><span class="o">=</span><span class="n">circular</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.sequence_to_md" class="doc doc-heading">
            <code class=" language-python"><span class="n">sequence_to_md</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;picoseconds&#39;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">310</span><span class="p">,</span> <span class="n">solvated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;my_dna&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;GROMACS&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dLk</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.sequence_to_md" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Simulate DNA sequence using OpenMM.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DNA sequence code.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>time</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Simulation time.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>time_unit</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time unit (picoseconds or nanoseconds).</p>
              </div>
            </td>
            <td>
                  <code>&#39;picoseconds&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>temperature</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Temperature in Kelvin.</p>
              </div>
            </td>
            <td>
                  <code>310</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>solvated</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solvate DNA with water and ions.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filename for pdb output.</p>
              </div>
            </td>
            <td>
                  <code>&#39;my_dna&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>save</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Save the trajectory.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Output format for the trajectory (GROMACS or HDF5).</p>
              </div>
            </td>
            <td>
                  <code>&#39;GROMACS&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shape</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shape of the DNA structure (linear or circular).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_bp</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of base pairs in the DNA structure.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>circular</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating if the DNA structure is circular.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dLk</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Change in linking number of the DNA structure.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>MDTraj</code></td>            <td>
                  <code>object</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>MDtraj trajectory object of DNA structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>This function uses the OpenMM library to simulate the behavior of a DNA sequence.</li>
<li>The simulation can be performed for a specified time period at a given temperature.</li>
<li>The DNA structure can be solvated with water and ions.</li>
<li>The trajectory of the simulation can be saved in either GROMACS or HDF5 format.</li>
<li>The shape of the DNA structure can be specified as linear or circular.</li>
<li>The number of base pairs in the DNA structure can be provided.</li>
<li>The change in linking number of the DNA structure can be specified.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <h3 id="pymdna.nucleic.sequence_to_md--simulate-a-linear-dna-structure-for-100-picoseconds-at-300-k">Simulate a linear DNA structure for 100 picoseconds at 300 K<a class="headerlink" href="#pymdna.nucleic.sequence_to_md--simulate-a-linear-dna-structure-for-100-picoseconds-at-300-k" title="Permanent link">&para;</a></h3>
<p>trajectory = sequence_to_md(sequence='ATCG', time=100, time_unit='picoseconds', temperature=300, shape='linear')</p>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sequence_to_md</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;picoseconds&#39;</span><span class="p">,</span><span class="n">temperature</span><span class="o">=</span><span class="mi">310</span><span class="p">,</span> <span class="n">solvated</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;my_dna&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;GROMACS&#39;</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">dLk</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate DNA sequence using OpenMM.</span>

<span class="sd">        Args:</span>
<span class="sd">            sequence (str): DNA sequence code.</span>
<span class="sd">            time (int): Simulation time.</span>
<span class="sd">            time_unit (str): Time unit (picoseconds or nanoseconds).</span>
<span class="sd">            temperature (int): Temperature in Kelvin.</span>
<span class="sd">            solvated (bool): Solvate DNA with water and ions.</span>
<span class="sd">            filename (str): Filename for pdb output.</span>
<span class="sd">            save (bool): Save the trajectory.</span>
<span class="sd">            output (str): Output format for the trajectory (GROMACS or HDF5).</span>
<span class="sd">            shape (str): Shape of the DNA structure (linear or circular).</span>
<span class="sd">            n_bp (int): Number of base pairs in the DNA structure.</span>
<span class="sd">            circular (bool): Flag indicating if the DNA structure is circular.</span>
<span class="sd">            dLk (int): Change in linking number of the DNA structure.</span>

<span class="sd">        Returns:</span>
<span class="sd">            MDTraj (object): MDtraj trajectory object of DNA structure.</span>

<span class="sd">        Notes:</span>
<span class="sd">            - This function uses the OpenMM library to simulate the behavior of a DNA sequence.</span>
<span class="sd">            - The simulation can be performed for a specified time period at a given temperature.</span>
<span class="sd">            - The DNA structure can be solvated with water and ions.</span>
<span class="sd">            - The trajectory of the simulation can be saved in either GROMACS or HDF5 format.</span>
<span class="sd">            - The shape of the DNA structure can be specified as linear or circular.</span>
<span class="sd">            - The number of base pairs in the DNA structure can be provided.</span>
<span class="sd">            - The change in linking number of the DNA structure can be specified.</span>

<span class="sd">        Example:</span>
<span class="sd">            # Simulate a linear DNA structure for 100 picoseconds at 300 K</span>
<span class="sd">            trajectory = sequence_to_md(sequence=&#39;ATCG&#39;, time=100, time_unit=&#39;picoseconds&#39;, temperature=300, shape=&#39;linear&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="c1"># TODO update with make function</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">openmm</span> <span class="k">as</span> <span class="nn">mm</span>
        <span class="kn">import</span> <span class="nn">openmm.app</span> <span class="k">as</span> <span class="nn">app</span>
        <span class="kn">import</span> <span class="nn">openmm.unit</span> <span class="k">as</span> <span class="nn">unit</span>
        <span class="kn">from</span> <span class="nn">mdtraj.reporters</span> <span class="kn">import</span> <span class="n">HDF5Reporter</span>
        <span class="kn">import</span> <span class="nn">mdtraj</span> <span class="k">as</span> <span class="nn">md</span>
        <span class="n">openmm_available</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="n">openmm_available</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Openmm is not installed. You shall not pass.&quot;</span><span class="p">)</span>

    <span class="n">pdb</span> <span class="o">=</span> <span class="n">sequence_to_pdb</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;my_dna&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;GROMACS&#39;</span><span class="p">,</span><span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">dLk</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">openmm_available</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;But here is your DNA structure&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pdb</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">time_unit</span> <span class="o">==</span> <span class="s1">&#39;picoseconds&#39;</span><span class="p">:</span>
            <span class="n">time_unit</span> <span class="o">=</span> <span class="n">time</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">picoseconds</span>
        <span class="k">elif</span> <span class="n">time_unit</span> <span class="o">==</span> <span class="s1">&#39;nanoseconds&#39;</span><span class="p">:</span>
            <span class="n">time_unit</span> <span class="o">=</span> <span class="n">time</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanoseconds</span>

        <span class="n">time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">*</span> <span class="n">time_unit</span>
        <span class="n">time_step</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">femtoseconds</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="mi">310</span> <span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">kelvin</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">/</span><span class="n">time_step</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Initialize DNA openMM simulation at </span><span class="si">{</span><span class="n">temperature</span><span class="o">.</span><span class="n">_value</span><span class="si">}</span><span class="s1"> K for&#39;</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="s1">&#39;time units&#39;</span><span class="p">)</span>
        <span class="n">topology</span> <span class="o">=</span> <span class="n">pdb</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">to_openmm</span><span class="p">()</span>
        <span class="n">modeller</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Modeller</span><span class="p">(</span><span class="n">topology</span><span class="p">,</span> <span class="n">pdb</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="n">forcefield</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">ForceField</span><span class="p">(</span><span class="s1">&#39;amber14-all.xml&#39;</span><span class="p">,</span> <span class="s1">&#39;amber14/tip3pfb.xml&#39;</span><span class="p">)</span>
        <span class="n">modeller</span><span class="o">.</span><span class="n">addHydrogens</span><span class="p">(</span><span class="n">forcefield</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">solvated</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Solvate DNA with padding of 1.0 nm and 0.1 M KCl&#39;</span><span class="p">)</span>
            <span class="n">modeller</span><span class="o">.</span><span class="n">addSolvent</span><span class="p">(</span><span class="n">forcefield</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">1.0</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">,</span> <span class="n">ionicStrength</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">molar</span><span class="p">,</span> <span class="n">positiveIon</span><span class="o">=</span><span class="s1">&#39;K+&#39;</span><span class="p">)</span>

        <span class="n">system</span> <span class="o">=</span> <span class="n">forcefield</span><span class="o">.</span><span class="n">createSystem</span><span class="p">(</span><span class="n">modeller</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">nonbondedMethod</span><span class="o">=</span><span class="n">app</span><span class="o">.</span><span class="n">CutoffNonPeriodic</span><span class="p">)</span>
        <span class="n">integrator</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">LangevinIntegrator</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">unit</span><span class="o">.</span><span class="n">picoseconds</span><span class="p">,</span> <span class="n">time_step</span><span class="p">)</span>

        <span class="n">simulation</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="n">modeller</span><span class="o">.</span><span class="n">topology</span><span class="p">,</span> <span class="n">system</span><span class="p">,</span> <span class="n">integrator</span><span class="p">)</span>
        <span class="n">simulation</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">setPositions</span><span class="p">(</span><span class="n">modeller</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
        <span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HDF5Reporter</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./</span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
        <span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">StateDataReporter</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./output_</span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">potentialEnergy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">speed</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Minimize energy&#39;</span><span class="p">)</span>
        <span class="n">simulation</span><span class="o">.</span><span class="n">minimizeEnergy</span><span class="p">()</span>

        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Run simulation for&#39;</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="s1">&#39;steps&#39;</span><span class="p">)</span>
        <span class="n">simulation</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
        <span class="n">simulation</span><span class="o">.</span><span class="n">reporters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Simulation completed&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saved trajectory as:&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;./</span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
        <span class="n">traj</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">load_hdf5</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./</span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">traj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="pymdna.nucleic.sequence_to_pdb" class="doc doc-heading">
            <code class=" language-python"><span class="n">sequence_to_pdb</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="s1">&#39;CGCGAATTCGCG&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;my_dna&#39;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;GROMACS&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dLk</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pymdna.nucleic.sequence_to_pdb" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

      <p>Generate a DNA structure from a DNA sequence code.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>sequence</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The DNA sequence code. Default is 'CGCGAATTCGCG'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;CGCGAATTCGCG&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>filename</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The filename for the pdb output. Default is 'my_dna'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;my_dna&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>save</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to save the pdb file. Default is True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>output</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of pdb DNA format. Default is 'GROMACS'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;GROMACS&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shape</code></td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Control points of shape (n,3) with n &gt; 3 that is used for spline interpolation to determine DNA shape. Default is None, which is a straight line.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>n_bp</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of base pairs to scale shape with. Default is None, then the sequence is used to determine n_bp.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>circular</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates if the structure is circular/closed. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dLk</code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Change in twist in terms of Linking number of DNA structure to output. Default is None, which corresponds to a neutral twist based on bp_per_turn = 10.5.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="mdtraj.Trajectory">Trajectory</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>md.Trajectory: An MDtraj trajectory object of the DNA structure (containing only a single frame).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the sequence is not provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The sequence argument must be provided.</li>
<li>The returned MDtraj object contains the DNA structure generated from the sequence and control points.</li>
<li>If the output is set to 'GROMACS', the DNA structure is edited to make it compatible with the AMBER force field.</li>
<li>The pdb file is saved in the current directory with the specified filename.</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <h3 id="pymdna.nucleic.sequence_to_pdb--generate-a-dna-structure-from-a-sequence">Generate a DNA structure from a sequence<a class="headerlink" href="#pymdna.nucleic.sequence_to_pdb--generate-a-dna-structure-from-a-sequence" title="Permanent link">&para;</a></h3>
<p>traj = sequence_to_pdb(sequence='CGCGAATTCGCG', filename='my_dna', save=True, output='GROMACS', shape=None, n_bp=None, circular=False, dLk=None)</p>
</details>
            <details class="quote">
              <summary>Source code in <code>pymdna/nucleic.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sequence_to_pdb</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;CGCGAATTCGCG&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;my_dna&#39;</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;GROMACS&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_bp</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">circular</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">dLk</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">md</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a DNA structure from a DNA sequence code.</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence (str, optional): The DNA sequence code. Default is &#39;CGCGAATTCGCG&#39;.</span>
<span class="sd">        filename (str, optional): The filename for the pdb output. Default is &#39;my_dna&#39;.</span>
<span class="sd">        save (bool, optional): Whether to save the pdb file. Default is True.</span>
<span class="sd">        output (str, optional): The type of pdb DNA format. Default is &#39;GROMACS&#39;.</span>
<span class="sd">        shape (np.ndarray, optional): Control points of shape (n,3) with n &gt; 3 that is used for spline interpolation to determine DNA shape. Default is None, which is a straight line.</span>
<span class="sd">        n_bp (int, optional): Number of base pairs to scale shape with. Default is None, then the sequence is used to determine n_bp.</span>
<span class="sd">        circular (bool, optional): Indicates if the structure is circular/closed. Default is False.</span>
<span class="sd">        dLk (int, optional): Change in twist in terms of Linking number of DNA structure to output. Default is None, which corresponds to a neutral twist based on bp_per_turn = 10.5.</span>

<span class="sd">    Returns:</span>
<span class="sd">        md.Trajectory: An MDtraj trajectory object of the DNA structure (containing only a single frame).</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the sequence is not provided.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The sequence argument must be provided.</span>
<span class="sd">        - The returned MDtraj object contains the DNA structure generated from the sequence and control points.</span>
<span class="sd">        - If the output is set to &#39;GROMACS&#39;, the DNA structure is edited to make it compatible with the AMBER force field.</span>
<span class="sd">        - The pdb file is saved in the current directory with the specified filename.</span>

<span class="sd">    Example:</span>
<span class="sd">        # Generate a DNA structure from a sequence</span>
<span class="sd">        traj = sequence_to_pdb(sequence=&#39;CGCGAATTCGCG&#39;, filename=&#39;my_dna&#39;, save=True, output=&#39;GROMACS&#39;, shape=None, n_bp=None, circular=False, dLk=None)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Check if the sequence is provided</span>
    <span class="k">if</span> <span class="n">sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The sequence argument must be provided.&quot;</span><span class="p">)</span>

    <span class="c1"># TODO: Update with make function</span>
    <span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span> <span class="o">=</span> <span class="n">_check_input</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">)</span>

    <span class="c1"># Linear strand of control points</span>
    <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">Shapes</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Convert the control points to a spline</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">SplineFrames</span><span class="p">(</span><span class="n">control_points</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">n_bp</span><span class="o">=</span><span class="n">n_bp</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="n">circular</span><span class="p">,</span> <span class="n">dLk</span><span class="o">=</span><span class="n">dLk</span><span class="p">)</span>

    <span class="c1"># Generate the DNA structure</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">StructureGenerator</span><span class="p">(</span><span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">,</span> <span class="n">spline</span><span class="o">=</span><span class="n">spline</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="n">circular</span><span class="p">)</span>

    <span class="c1"># Edit the DNA structure to make it compatible with the AMBER force field</span>
    <span class="n">traj</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">traj</span>
    <span class="k">if</span> <span class="n">output</span> <span class="o">==</span> <span class="s1">&#39;GROMACS&#39;</span><span class="p">:</span>
        <span class="n">phosphor_termini</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;name P OP1 OP2 and resid 0 </span><span class="si">{</span><span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">n_residues</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">all_atoms</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
        <span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">atom_slice</span><span class="p">([</span><span class="n">at</span> <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">all_atoms</span> <span class="k">if</span> <span class="n">at</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">phosphor_termini</span><span class="p">])</span>

    <span class="c1"># Save the DNA structure as a pdb file</span>
    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">traj</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s1">.pdb&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">traj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>